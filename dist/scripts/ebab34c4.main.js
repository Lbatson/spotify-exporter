function displayPlaylistItems(){$("#results").empty();var a=Handlebars.compile($("#playlist-list").html());$("#results").append(a(playlist.items))}function retrieveUserAndPlaylist(){$.ajax({url:apiUrl+"/me",headers:{Authorization:"Bearer "+accessToken}}).then(function(a){return user=a,$.ajax({url:apiUrl+"/users/"+user.id+"/playlists",headers:{Authorization:"Bearer "+accessToken}})}).then(function(a){playlist=a,displayPlaylistItems()}).fail(function(a){console.log("error: ",a)})}var authUrl="https://accounts.spotify.com/authorize",apiUrl="https://api.spotify.com/v1",clientId="f880219b69b349bf8683bbcd1091410a",redirectUri="http://spotify-exporter.lancebatson.me",responseType="token",scopes="playlist-read-private",accessToken="",user={},playlist={};jQuery.extend({getQueryParameters:function(a){return(a||document.location.search).replace(/(^\?)/,"").split("&").map(function(a){return a=a.split("="),this[a[0]]=a[1],this}.bind({}))[0]}}),$("#authorize").on("click",function(){var a=authUrl+"?";a+=$.param({client_id:clientId,redirect_uri:redirectUri,response_type:responseType,scope:scopes}),window.location.href=a}),$(document).on("click",".export",function(){var a=$(this);if(a.data("owner")===user.id||a.data("ispublic")){var b=$(this).data("id");$.ajax({url:apiUrl+"/users/"+user.id+"/playlists/"+b+"/tracks",headers:{Authorization:"Bearer "+accessToken}}).then(function(b){var c="data:text/csv;charset=utf-8,";b.items.forEach(function(a){c+=a.track.name+","+a.track.album.name+","+a.track.artists[0].name+"\n"}),c=c.trim(),a.removeClass("btn-spotify"),a.text("Download"),a.attr("download",a.data("name")+".csv"),a.attr("href",encodeURI(c))}).fail(function(a){console.log("error: ",a)})}else alert("Unable to export private playlist from another user")}),$(function(){var a=window.location.href;if(-1!==a.search("#access_token")){$("#authorize").hide();var b=a.split("#")[1];b=$.getQueryParameters(b),accessToken=b.access_token,retrieveUserAndPlaylist()}});